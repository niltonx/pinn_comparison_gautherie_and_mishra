import numpy as np
import matplotlib.pyplot as plt

# --- 1. Dados Experimentais [Gautherie (1980)] ---
X = np.array([0.0019, 0.0053, 0.0078, 0.0109, 0.0175, 0.0269, 0.0319, 0.0355, 0.0395, 0.0464, 0.053, 0.0594, 0.0618, 0.0656])
TGaut = np.array([34.1664, 34.5356, 34.8505, 35.4466, 36.3871, 36.8066, 36.624, 36.4868, 36.3001, 36.151, 36.1275, 36.1792, 36.1131, 36.154])
x1=100*X
# --- 2. Simulação Numérica [Mishra (2015)] ---
a = np.array([0.000205, 0.004608, 0.00727, 0.009727, 0.015973, 0.026109, 0.031638, 0.03471, 0.038805, 0.045973, 0.052321, 0.058362])
Tmisha = np.array([33.9725, 34.7963, 35.492, 36.2975, 37.2128, 37.341, 36.865, 36.5538, 36.3341, 36.2059, 36.2059, 36.2792])
a1=100*a

##---cfd
T2020131_raw = [
 3.070859881000000e+02, 3.073126527000000e+02, 3.073412195000000e+02, 3.073702239000000e+02, 3.073935866000000e+02,
 3.077377766000000e+02, 3.078381010000000e+02, 3.078912434000000e+02, 3.080642439000000e+02, 3.082431911000000e+02,
 3.082584452000000e+02, 3.083503767000000e+02, 3.087456724000000e+02, 3.087675279000000e+02, 3.087874268000000e+02,
 3.089152974000000e+02, 3.090923736000000e+02, 3.091109619000000e+02, 3.091155947000000e+02, 3.094365948000000e+02,
 3.094618720000000e+02, 3.095148573000000e+02, 3.096137175000000e+02, 3.096329155000000e+02, 3.097698421000000e+02,
 3.098600804000000e+02, 3.098971191000000e+02, 3.099066908000000e+02, 3.099672466000000e+02, 3.099733871000000e+02,
 3.100013142000000e+02, 3.100421481000000e+02, 3.100540284000000e+02, 3.100753070000000e+02, 3.100928592000000e+02,
 3.100945544000000e+02, 3.100992695000000e+02, 3.101067454000000e+02, 3.101075311000000e+02, 3.101093560000000e+02,
 3.101096412000000e+02, 3.101042940000000e+02, 3.100942173000000e+02, 3.100762629000000e+02, 3.100759936000000e+02,
 3.100619081000000e+02, 3.100617717000000e+02, 3.100598736000000e+02, 3.100561599000000e+02, 3.100124472000000e+02,
 3.099934314000000e+02, 3.099714973000000e+02, 3.099455671000000e+02, 3.098928665000000e+02, 3.098514583000000e+02,
 3.097689796000000e+02, 3.096935730000000e+02, 3.096860513000000e+02, 3.096358084000000e+02, 3.096045757000000e+02,
 3.095911248000000e+02, 3.095686884000000e+02, 3.095310808000000e+02, 3.095211974000000e+02, 3.095009297000000e+02,
 3.094986767000000e+02, 3.094760570000000e+02, 3.094747008000000e+02, 3.094742699000000e+02, 3.094644210000000e+02,
 3.094616375000000e+02, 3.094616127000000e+02, 3.094537578000000e+02, 3.094735988000000e+02, 3.094736296000000e+02,
 3.094842771000000e+02, 3.094844373000000e+02, 3.094911545000000e+02, 3.095082637000000e+02, 3.095145835000000e+02,
 3.095240650000000e+02, 3.095266381000000e+02, 3.095484733000000e+02, 3.095509937000000e+02, 3.095580810000000e+02,
 3.095897433000000e+02, 3.096179809000000e+02, 3.096261491000000e+02, 3.096404844000000e+02, 3.096479900000000e+02,
 3.096545333000000e+02, 3.096567530000000e+02, 3.096584718000000e+02, 3.096631308000000e+02, 3.096678579000000e+02,
 3.096784677000000e+02, 3.096807246000000e+02
]

Z2020_raw = [
 -8.997432435000000e-02, -8.846891776000000e-02, -8.827105988000000e-02, -8.807672286000000e-02, -8.792032402000000e-02,
 -8.552395509999999e-02, -8.494416278000000e-02, -8.464209726999999e-02, -8.365882369000000e-02, -8.273635015000000e-02,
 -8.266017924000001e-02, -8.220106013000000e-02, -8.066049509999999e-02, -8.056987295000000e-02, -8.048891314999999e-02,
 -7.993362397999999e-02, -7.915987114000000e-02, -7.907498695000000e-02, -7.905381884000000e-02, -7.756459478000000e-02,
 -7.744134529000001e-02, -7.707603620000000e-02, -7.634905587000000e-02, -7.620783061000000e-02, -7.507109173000000e-02,
 -7.392198689000000e-02, -7.345035335000000e-02, -7.331359585000000e-02, -7.238434565000000e-02, -7.224001612000000e-02,
 -7.158240930000000e-02, -7.061501655999999e-02, -7.028486549000000e-02, -6.915833640999999e-02, -6.822888159000000e-02,
 -6.814403443000000e-02, -6.790395140000000e-02, -6.752498989000000e-02, -6.733589583000001e-02, -6.690397508000000e-02,
 -6.639414285000000e-02, -6.541971746000000e-02, -6.473645040000001e-02, -6.348740969000000e-02, -6.346906172000000e-02,
 -6.268351347999999e-02, -6.267567813000000e-02, -6.258339296000000e-02, -6.248551525000000e-02, -6.137541615000000e-02,
 -6.087755451000000e-02, -6.030365791000000e-02, -5.965522014000000e-02, -5.886306628000000e-02, -5.827576758000000e-02,
 -5.712738070000000e-02, -5.594627975000000e-02, -5.582841628000000e-02, -5.510673312000000e-02, -5.466938021000000e-02,
 -5.433568855000000e-02, -5.380848395000000e-02, -5.301903625000000e-02, -5.281144216000000e-02, -5.160618716000000e-02,
 -5.147259401000000e-02, -5.031316876000000e-02, -5.024030472000000e-02, -5.010502628000000e-02, -4.882927404000000e-02,
 -4.745663839000000e-02, -4.744924179000000e-02, -4.547463173000000e-02, -4.284731761000000e-02, -4.284418334000000e-02,
 -4.153430682000000e-02, -4.151216118000000e-02, -4.058516253000000e-02, -3.921926988000000e-02, -3.870510861000000e-02,
 -3.790721081000000e-02, -3.767207173000000e-02, -3.567679717000000e-02, -3.547207782000000e-02, -3.489774246000000e-02,
 -3.213108697000000e-02, -2.923074672000000e-02, -2.834953979000000e-02, -2.680204453000000e-02, -2.597242612000000e-02,
 -2.518491101000000e-02, -2.486123249000000e-02, -2.461222996000000e-02, -2.372638269000000e-02, -2.282804937000000e-02,
 -2.053853865000000e-02, -1.964914710000000e-02
]

# Convert to NumPy arrays
T2 = np.array(T2020131_raw)
Z2 = np.array(Z2020_raw)

t21=T2-273.15

z21=(Z2+8.997432435000000e-02)*100

# --- 3. Dados PINN (Z, T) ---
pinn_data_str = """
2.0000    36.8898
2.0352    36.8869
2.0704    36.8839
2.1055    36.8810
2.1407    36.8781
2.1759    36.8752
2.2111    36.8722
2.2462    36.8693
2.2814    36.8664
2.3166    36.8635
2.3518    36.8605
2.3869    36.8576
2.4221    36.8547
2.4573    36.8518
2.4925    36.8489
2.5276    36.8461
2.5628    36.8432
2.5980    36.8404
2.6332    36.8375
2.6683    36.8347
2.7035    36.8319
2.7387    36.8292
2.7739    36.8264
2.8090    36.8237
2.8442    36.8210
2.8794    36.8184
2.9146    36.8158
2.9497    36.8132
2.9849    36.8106
3.0201    36.8082
3.0553    36.8057
3.0905    36.8033
3.1256    36.8010
3.1608    36.7987
3.1960    36.7965
3.2312    36.7944
3.2663    36.7923
3.3015    36.7903
3.3367    36.7884
3.3719    36.7866
3.4070    36.7849
3.4422    36.7833
3.4774    36.7818
3.5126    36.7805
3.5477    36.7792
3.5829    36.7781
3.6181    36.7771
3.6533    36.7763
3.6884    36.7757
3.7236    36.7752
3.7588    36.7750
3.7940    36.7749
3.8291    36.7750
3.8643    36.7754
3.8995    36.7760
3.9347    36.7769
3.9698    36.7780
4.0050    36.7794
4.0402    36.7811
4.0754    36.7832
4.1106    36.7855
4.1457    36.7883
4.1809    36.7914
4.2161    36.7949
4.2513    36.7988
4.2864    36.8031
4.3216    36.8079
4.3568    36.8133
4.3920    36.8192
4.4271    36.8257
4.4623    36.8330
4.4975    36.8410
4.5327    36.8499
4.5678    36.8596
4.6030    36.8703
4.6382    36.8817
4.6734    36.8938
4.7085    36.9064
4.7437    36.9192
4.7789    36.9320
4.8141    36.9446
4.8492    36.9566
4.8844    36.9681
4.9196    36.9788
4.9548    36.9887
4.9899    36.9979
5.0251    37.0064
5.0603    37.0143
5.0955    37.0215
5.1307    37.0283
5.1658    37.0346
5.2010    37.0404
5.2362    37.0458
5.2714    37.0508
5.3065    37.0555
5.3417    37.0598
5.3769    37.0637
5.4121    37.0673
5.4472    37.0705
5.4824    37.0733
5.5176    37.0758
5.5528    37.0779
5.5879    37.0797
5.6231    37.0811
5.6583    37.0822
5.6935    37.0829
5.7286    37.0832
5.7638    37.0831
5.7990    37.0827
5.8342    37.0820
5.8693    37.0808
5.9045    37.0792
5.9397    37.0773
5.9749    37.0749
6.0101    37.0722
6.0452    37.0690
6.0804    37.0653
6.1156    37.0611
6.1508    37.0565
6.1859    37.0513
6.2211    37.0455
6.2563    37.0392
6.2915    37.0322
6.3266    37.0245
6.3618    37.0160
6.3970    37.0068
6.4322    36.9967
6.4673    36.9856
6.5025    36.9736
6.5377    36.9604
6.5729    36.9460
6.6080    36.9303
6.6432    36.9132
6.6784    36.8946
6.7136    36.8743
6.7487    36.8522
6.7839    36.8283
6.8191    36.8024
6.8543    36.7744
6.8894    36.7443
6.9246    36.7119
6.9598    36.6772
6.9950    36.6401
7.0302    36.6005
7.0653    36.5582
7.1005    36.5128
7.1357    36.4637
7.1709    36.4104
7.2060    36.3522
7.2412    36.2890
7.2764    36.2215
7.3116    36.1517
7.3467    36.0816
7.3819    36.0130
7.4171    35.9468
7.4523    35.8831
7.4874    35.8217
7.5226    35.7623
7.5578    35.7045
7.5930    35.6482
7.6281    35.5931
7.6633    35.5390
7.6985    35.4860
7.7337    35.4339
7.7688    35.3826
7.8040    35.3321
7.8392    35.2824
7.8744    35.2333
7.9095    35.1849
7.9447    35.1371
7.9799    35.0898
8.0151    35.0430
8.0503    34.9966
8.0854    34.9506
8.1206    34.9050
8.1558    34.8597
8.1910    34.8147
8.2261    34.7699
8.2613    34.7253
8.2965    34.6809
8.3317    34.6366
8.3668    34.5925
8.4020    34.5484
8.4372    34.5045
8.4724    34.4605
8.5075    34.4166
8.5427    34.3727
8.5779    34.3287
8.6131    34.2847
8.6482    34.2407
8.6834    34.1965
8.7186    34.1523
8.7538    34.1079
8.7889    34.0634
8.8241    34.0187
8.8593    33.9738
8.8945    33.9288
8.9296    33.8835
8.9648    33.8379
9.0000    33.7921
"""

# Process the PINN data
data_lines = pinn_data_str.strip().split('\n')
Z = []
T = []
for line in data_lines:
    try:
        # Use split() to handle variable whitespace
        z_val, t_val = map(float, line.split())
        Z.append(z_val)
        T.append(t_val)
    except ValueError:
        # Skip lines that are headers or separators
        continue

Z = np.array(Z)
T = np.array(T)

# CRITICAL STEP: Calculate z1 = 9 - Z as requested
z1 = 9 - Z

# --- 4. Plotting ---
plt.figure(figsize=(10, 6))

# Plot 1: Experimental Data (X, TGaut) - Pontos Discretos
plt.plot(x1, TGaut, 'o', label='Dados experimentais [Gautherie (1980)]', color='red', markersize=5)

# Plot 2: Numerical Simulation (a, Tmisha) - Pontos Discretos
plt.plot(a1, Tmisha, 's', label='Simulação numérica [Mishra (2015)]', color='blue', markersize=5)

# Plot 3: PINN Results (z1, T) - Linha Contínua
plt.plot(z1, T, '-', label='Resultado PINN ', color='green', linewidth=2)


# Plot 4: PINN Results (z1, T) - Linha Contínua
#plt.plot(z21, t21, '-', label='CFD Result', color='black', linewidth=2)

# Set labels and title
plt.xlabel('Distância radial (cm)', fontsize=14)
plt.ylabel('Temperatura ($T$) (°C)', fontsize=14)
plt.title('Comparação de Perfis de Temperatura', fontsize=16)
plt.legend(fontsize=12, loc='best')
plt.grid(True, linestyle='--', alpha=0.6)

plt.tight_layout()
plt.show()
